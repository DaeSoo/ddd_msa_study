# MSA

## 1. Cloud 인프라의 등장

- 일반적인 인프라 구축절차

```ssh
서버실 공사 -> 서버장비 구입 네트워크 연결 -> 운영체제 및 S/W설치
위는 일반적인 인프라 구축 절차는 많은 시간이 소요된다.

초기비용 투자가 많아지고, 관리하는 비용또한 증대하기 기존 인프라구조는 비용적인 측면에서
이점이 적다.(새로 구축하는 경우)
때문에 클라우드 인프라가 생기면서 이 문제를 해결하였고, 클라우드 벤더들은 비즈니스 개발의
민첩성을 위해 많은 기능들을 제공한다.

```

- 클라우드 인프라의 어울리는 어플리케이션

```ssh
클라우드 인프라의 장점은 사용량에 따라 비용을 유연하게 조정하는 장점이 있고, 사용량 만큼
비용을 지불한다.

트래픽이 몰릴 경우 트래픽을 예상하여 시스템 용량을 증설하고, 트래픽이 줄어들을 경우에는
원래 용량의 줄여서 사용한다.

클라우드는 여러 개의 서버 장비가 모여 논리적으로 하나처럼 관리된다. 레고처럼 조각 조각이
모여 하나의 큰덩어리가 되고 분리되기도 한다. 클라우드 인프라는 애플리케이션의 블록이
작으면 작을수록 효율적이고, 사용량이 증가할 운영 시점이라면 서비스 비용을 유연하게 관리가 가능하다.

스케일 업과 스케일 다운
스케일 업 : 기존 시스템 자체의 물리적 용량을 증가시켜 성능을 높이는 방법이다.
사용량이 많아진다는것은 데이터 처리가 증가한다는 것이고을 담을 그릇도 커져야한다.

스케일 다운 : 기존 시스템과 용량이 같은 다수의 장비를 병행 추가해서 가용성을 높이는 방법이다.
즉 사용량을 분산시켜 전체적으로 장애 없이 운영된다.

특정 서비스만 탄력성 있게 확장(스케일 아웃)
전체가 하나로 묶여 있는 애플리케이션을 블록처럼 분리하여, 트래픽이 많이 발생하는 모듈만
스케일 아웃하여 트래픽을 분산처리하게 되면 된다.
시스템을 작은 단위의 독립적인 서비스 연계로 구성해야 한다.


```

## 2. 마이크로서비스란 무엇인가?

```ssh
전통적인 시스템 구조인 모노리스(monolith)

Client <-> 모노리스 <-> 데이터베이스

모노리스는 하나의 단위로 개발되는 일체식 애플리케이션이다.
서버 측 애플리케이션이 일체, 즉 논리적인 단일체로서 아무리 작은 변화에도 새로운 버전으로
전체를 빌드해서 포함해야 한다. 일체식 애플리케이션은 단일 프로세스에서 실행되기 때문에
확장이 필요한 경우 마이크로서비스 기반 시스템을 바탕으로 확장 할수 없고, 전체 애플리케이션을
동시에 확장해야 한다. 보통 로드 밸런서 앞에 두고 여러 인스턴스 위에 큰 덩어리를 복제해 
수평으로 확장한다.
변경이 발생시 수평으로 확장이 된 상태이므로 여러개의 모노리스 시스템을 모두 전부 다시 빌드하고
배포해야 한다. 또한 확장 시 애플리케이션이 병렬로 확장되어 사용량 증가에 대응할 수 있지만
데이터베이스는 통합되어 하나이므로 탄련적으로 대응할 수 없다. 따라서 사전에 성능을 감당하기 위해
스케일업을 통해 용량을 증설해야한다.

마이크로서비스(MicroService)
마이크로서비스는 서버 측이 여러개의 조각으로 구성돼 각 서비스가 별개의 인스턴스로 로딩된다.
즉 여러 서비스 인스턴스가 모여 하나의 비즈니스 애플리케이션을 구성한다. 또한 각기 저장소가
다르므로 업무 단위로 모듈 경계가 명확하게 구분된다. 따라서 확장 시에는 특정 기능별로 독립적으로
확장할 수 있고, 특정 서비스를 변경할 필요가 있다면 해당 서비스만 빌드해서 배포하면 된다.
또 각 서비스가 독립적이어서 서로 다른 언어로 개발하는 것도 가능하므로 각 서비스의 소유권을
분리해 서로 다른 팀이 개발 및 운영할 수 있다.
서비스를 잘게 쪼개어 필요한 서비스에만 스케일 아웃 할 수 있다.

```

- SOA와 마이크로서비스
```ssh
소프트웨어 공학에서 발전흐름
구조적 방법론 -> 객체지향 방법론 -> CBD(Comonent Base Devlopment) -> SOA(Sevice Oriented Architecture)

SOA : 컴포넌트를 모아 비즈니스적으로 의미 있고 완결적인 서비스 단위로 모듈화

CBD와 SOA도 넓게 보면 단위 컴포넌트나 서비스를 구성해서 시스템을 만드는 개념이고
마이크로서비스 시스템 구조와 매우 유사하다.
넓게 보면 여러개의 응집된 비즈니스 서비스의 집합으로 시스템을 개발한다는 점에서 SOA와
MSA는 개념적으로는 크게 다르지 않지만, SOA는 구체적이지 않고 이론적이며, 실제로 비즈니스에서
성공사례가 많지 않다. 반면 MSA는 클라우드 인프라 기술의 발전과 접목되어 널리 성공하였다.
즉 이상적이었지만 성공을 증명하지 못했던 SOA가 클라우드 인프라의 등장으로 하드웨어를 유연하게
다룰 수 있게 되면서 비로서 성공하여 증명된 시스템이 MSA라 할 수 있다.

마이크로서비스는 서비스와 저장소는 다른 서비스 및 저장소와 격리돼 있으며, API를 통해서 느슨하게 연계된다.
따라서 독립적으로 확장이 가능하고 하나의 서비스만 독립적으로 배포 가능하다. 또한 다른 서비스와 연계된 API에
영향을 주지 않는 다면 내부의 언어나 저장소는 자율적으로 선택할 수 있다.

서비스 API (어떠한 언어도 가능) < - > 데이터베이스(...어떠한 데이터베이스 가능)

특정서비스를 구축하는 데 사용되는 언어나 저장소를 자율적으로 선택할 수 있는 방식을 가리켜
폴리글랏(Polyglot)하다라고 표현한다. 

여기서 이러한 폴리글랏 저장소 같은 특성을 통해 CBD/SOA가 추구했던 미흡했던 모듈화를 비로소 실현할 수 있었던
MSA와 CBD/SOA와의 차이를 발견할 수 있다.(기존 방식은 여러 애플리케이션이 하나의 저장소를 통합하여 공유)

1. 서비스별 저장소를 분리해서 다른 서비스가 저장소를 직접 호출하지 못하도록 캡슐화한다. 즉 다른 서비스의
저장소에 접근하는 수단은 API밖에없다.
2. REST API 같은 가벼운 개방형 표준을 사용해 각 서비스가 느슨하게 연계되고 누구나 쉽게 사용이 가능하다.

```

## 3. 마이크로서비스를 위한 조건은 무엇인가?